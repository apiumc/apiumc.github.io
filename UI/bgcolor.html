<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>API UMC</title>
    <script src="/js/umc.js" type="text/javascript"></script>
    <style>
        body {
            padding: 0;
            margin: 0;
        }

        .theme_area {
            padding: 6px;
        }

        .theme_area a {
            color: #333;
            text-decoration: none;
        }

        div.wallpaper_settingButton,
        a.theme_setting,
        div.theme_upload {
            display: inline;
            float: left;
            margin: 5px 8px 5px 8px;
            width: 172px;
            height: 140px;
            cursor: pointer;
            border-radius: 5px
        }

        a.theme_setting {
            background: #cbe7fc;
            transition: all 0.5s;
        }

        a.theme_setting:hover {
            background: #75c1f9
        }

        div.themeSetting_hover {
            background: #75c1f9
        }

        div.theme_select,
        a.theme_select {
            background: #75c1f9
        }

        .theme_icon {
            margin: 5px auto;
            padding-top: 3px;
            width: 140px;
            height: 100px;
            border-radius: 5px;
            text-align: center;
        }

        .theme_icon img {
            width: 140px;
            height: 100px;
        }

        .theme_text {
            margin: 5px 0 0 0;
            text-align: center;
            font-size: 12px;
            text-decoration: none;
        }

        .theme_text a {
            text-decoration: none;
        }

        .theme_text a:link {
            text-decoration: none;
        }

        div.theme_upload {
            background: #e9e9e9;
            transition: all 0.5s;
        }

        div.theme_upload:hover {
            background: #75c1f9
        }

        .clear {
            clear: both;
        }

        .h10 {
            clear: both;
            height: 10px;
        }

        html::-webkit-scrollbar,
        body::-webkit-scrollbar {
            width: 0px;
            height: 0px;
        }
    </style>
    <script>
        UMC(function ($) {
            var callFn = function () { }
            UMC.UI.Bridge = function (v, fn) {
                callFn = fn;
                window.top.postMessage(JSON.stringify({
                    type: 'umc',
                    value: v
                }), "*");

            }
            $(window).on('message', function (e) {
                var data = {};
                try {
                    data = JSON.parse(e.data);
                } catch (c) {
                    return;
                }
                switch (data.type) {
                    case 'umc':
                        UMC.UI.Ready(data.data, callFn);
                        break;
                    default:
                        break;
                }
            });
            var themes = [{
                "pic": "/css/images/BgSrc/bg1.jpg",
                "title": "win10"
            }, {
                "pic": "/css/images/BgSrc/bg2.jpg",
                "title": "梦幻光影"
            }, {
                "pic": "/css/images/BgSrc/bg3.jpg",
                "title": "扬帆起航"
            }, {
                "pic": "/css/images/BgSrc/bg4.jpg",
                "title": "乡土气息"
            }, {
                "pic": "/css/images/BgSrc/bg5.jpg",
                "title": "绿色清新"
            }, {
                "pic": "/css/images/BgSrc/bg6.jpg",
                "title": "Win8"
            }, {
                "pic": "/css/images/BgSrc/bg7.jpg",
                "title": "蓝色海岸"
            }, {
                "pic": "/css/images/BgSrc/bg8.jpg",
                "title": "冰天雪地"
            }, {
                "pic": "/css/images/BgSrc/bg9.jpg",
                "title": "繁花满树"
            }, {
                "pic": "/css/images/BgSrc/bg10.jpg",
                "title": "精灵小鸟"
            }, {
                "pic": "/css/images/BgSrc/bg11.jpg",
                "title": "炫酷跑车"
            }, {
                "pic": "/css/images/BgSrc/bg12.jpg",
                "title": "中国风"
            }, {
                "pic": "/css/images/BgSrc/bg13.jpg",
                "title": "Winxp"
            }, {
                "pic": "/css/images/BgSrc/bg14.jpg",
                "title": "淡雅唯美"
            }, {
                "pic": "/css/images/BgSrc/bg15.jpg",
                "title": "Win7"
            },];

            var theme_area = $("#theme_area");
            theme_area.on('click', '.theme_setting', function () {
                var pic = $(this).attr('data-pic');
                window.top.postMessage(JSON.stringify({
                    type: 'bgsrc',
                    value: pic
                }), "*");

            });
            $.UI.On('BgSrc', function (e, v) {

                window.top.postMessage(JSON.stringify({
                    type: 'bgsrc',
                    value: v.src
                }), "*");
            });
            $('#btn-upload').find('input').change(function () {
                var v = this.files;
                if (v.length > 0) {
                    var me = this;
                    var file = v[0];
                    var formdata = new FormData();
                    var fname = file.name.substr(file.name.lastIndexOf('.')).toLocaleLowerCase();
                    switch (fname) {
                        case '.jpg':
                        case '.png':
                        case '.gif':
                        case '.webp':
                        case '.jpeg':
                            break;
                        default:
                            window.top.postMessage(JSON.stringify({
                                type: 'msg',
                                value: "文件格式不支持"
                            }), "*");
                            return;
                    }
                    var media_id = '/TEMP/' + Math.random() + fname;
                    var xhr = new XMLHttpRequest();
                    xhr.onload = function () {
                        me.value = '';
                        UMC.UI.Command('Proxy', 'App', {
                            Key: 'BgSrc',
                            media_id: media_id
                        });
                    };
                    xhr.open('PUT', media_id, true);
                    xhr.send(file);

                }
            });

            for (var i = 0; i < themes.length; i++) {
                var t = themes[i];
                var theme = $({
                    tag: 'a',
                    cls: 'theme_setting',
                    'data-pic': t.pic
                }).html("<div class=\"theme_icon\"><img src=\"" + t.pic + "?umc-image=w150\"></div>" +
                    "<div class=\"theme_text\">" + t.title + "</div>")
                theme_area.append(theme)
            }


        });
    </script>
</head>

<body>
    <!--主题设置-->
    <div id="theme_body">
        <div id="theme_area" class="theme_area">
            <!--主题图片-->
            <div id="btn-upload" class="theme_upload">
                <div class="theme_icon"
                    style="background-image: url(/css/images/uploadbg.png);background-size:100% 100%;">
                    <input accept="image/jpg,image/jpeg,image/png,image/gif"
                        style="opacity: 0;display: block;width:100%;height:100px;" type="file">
                    <div class="theme_text">自定义上传</div>
                </div>
            </div>
        </div>
        <div class="h10"></div>
    </div>
    <div class="clear"></div>

</body>

</html>